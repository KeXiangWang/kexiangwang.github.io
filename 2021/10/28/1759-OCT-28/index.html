<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/bitbug_favicon-32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/bitbug_favicon-16x16.ico">
  <link rel="mask-icon" href="/images/bitbug_favicon-32x32.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.kexiang.me","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":"mac","style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="This is a &#39;Paper Reading&#39; post for Course ECE1759. The topic is &#39;File System&#39;. This paper list is here:  Marshall K. McKusick, William N. Joy, Samuel J. Leffler, and Robert S. Fabry, &quot;A Fast Fil">
<meta property="og:type" content="article">
<meta property="og:title" content="1759 &#39;File System&#39; OCT-28">
<meta property="og:url" content="https://www.kexiang.me/2021/10/28/1759-OCT-28/index.html">
<meta property="og:site_name" content="kexiang&#39;s blog">
<meta property="og:description" content="This is a &#39;Paper Reading&#39; post for Course ECE1759. The topic is &#39;File System&#39;. This paper list is here:  Marshall K. McKusick, William N. Joy, Samuel J. Leffler, and Robert S. Fabry, &quot;A Fast Fil">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-10-28T19:22:54.000Z">
<meta property="article:modified_time" content="2021-12-01T01:09:41.114Z">
<meta property="article:author" content="Kexiang Wang">
<meta property="article:tag" content="Systems">
<meta property="article:tag" content="Paper Reading">
<meta property="article:tag" content="OS">
<meta property="article:tag" content="File Systems">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://www.kexiang.me/2021/10/28/1759-OCT-28/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>1759 'File System' OCT-28 | kexiang's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">kexiang's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    

  <a href="https://github.com/KeXiangWang" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://www.kexiang.me/2021/10/28/1759-OCT-28/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar-time.jpg">
      <meta itemprop="name" content="Kexiang Wang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="kexiang's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          1759 'File System' OCT-28
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-10-28 15:22:54" itemprop="dateCreated datePublished" datetime="2021-10-28T15:22:54-04:00">2021-10-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-11-30 20:09:41" itemprop="dateModified" datetime="2021-11-30T20:09:41-05:00">2021-11-30</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Academic/" itemprop="url" rel="index"><span itemprop="name">Academic</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Academic/Paper-Reading/" itemprop="url" rel="index"><span itemprop="name">Paper Reading</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Academic/Paper-Reading/1759/" itemprop="url" rel="index"><span itemprop="name">1759</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Academic/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Academic/File-System/" itemprop="url" rel="index"><span itemprop="name">File System</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine: </span>
    
    <a title="valine" href="/2021/10/28/1759-OCT-28/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2021/10/28/1759-OCT-28/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">Symbols count in article: </span>
              <span>8k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">Reading time &asymp;</span>
              <span>7 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>This is a 'Paper Reading' post for Course ECE1759. The topic is 'File System'. This paper list is here:</p>
<ul>
<li>Marshall K. McKusick, William N. Joy, Samuel J. Leffler, and Robert S. Fabry, &quot;A Fast File System for Unix,&quot; ACM Transactions on Computer Systems, 2(3), August 1984, pp. 181-197.</li>
<li>Mendel Rosenblum and John K. Ousterhout, &quot;The Design and Implementation of a Log-Structured File System,&quot; Proceedings of the 13th ACM Symposium on Operating Systems Principles, December 1991.</li>
<li>Gregory R. Ganger, Marshall Kirk McKusick, Craig A.N. Soules, and Yale N. Patt. &quot;Soft Updates: A Solution to the Metadata Update Problem in File Systems,&quot; ACM Transactions on Computer Systems, Vol. 18, No. 2, May 2000, Pages 127-153.</li>
</ul>
</blockquote>
<h1 id="a-fast-file-system-for-unix"><a class="markdownIt-Anchor" href="#a-fast-file-system-for-unix"></a> A Fast File System for Unix</h1>
<h2 id="introduction"><a class="markdownIt-Anchor" href="#introduction"></a> Introduction</h2>
<ul>
<li>Original UNIX file system:
<ul>
<li>File system I/0 is buffered by the kernel; there are no alignment constraints on data transfers and all operations are made to appear synchronous.</li>
<li>A file system never spans multiple partitions.</li>
</ul>
</li>
<li>The original 512-byte UNIX file system is incapable of providing the data throughput rates that many applications require.</li>
<li>A file system providing higher bandwidth is needed.</li>
<li>Several Improvement of Previous work
<ul>
<li>Changing the basic block size from  512 to 1024 bytes.
<ul>
<li>Changing the basic block size from  512 to 1024 bytes.</li>
<li>Most files could be described without need to access indirect blocks since the direct blocks contained twice as much data</li>
</ul>
</li>
<li>Have a process that periodically reorganized the data on the disk to restore locality
<ul>
<li>The free list was initially ordered for optimal access, it quickly became scrambled as files were created and removed.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="core-ideas"><a class="markdownIt-Anchor" href="#core-ideas"></a> Core Ideas</h2>
<h3 id="ffs"><a class="markdownIt-Anchor" href="#ffs"></a> FFS</h3>
<ul>
<li>The superblock is replicated to protect against catastrophic loss.
<ul>
<li>Since the superblock  data does not change, the copies need not be referenced unless a hard error.</li>
</ul>
</li>
<li>To create files as large as 2^32 bytes with only two levels of indirection, the file size system block is 4096 bytes.
<ul>
<li>Can not be changed without rebuilding the file  system.</li>
</ul>
</li>
<li>Divides a disk partition into one or more  areas called cylinder groups.
<ul>
<li>Consist of one or more consecutive cylinders on a disk.</li>
<li>At a varying offset from  the beginning of each cylinder group, there are
<ul>
<li>a redundant copy of the superblock</li>
<li>space for inodes</li>
<li>a bit map describing available blocks in the cylinder group</li>
<li>summary information describing the usage of data blocks within the cylinder group</li>
</ul>
</li>
<li>Bit map of available blocks in the cylinder group replaces the  traditional file system's free list.</li>
<li>For each cylinder group a static number of inodes is allocated at file system creation time</li>
</ul>
</li>
</ul>
<h3 id="larger-blocks"><a class="markdownIt-Anchor" href="#larger-blocks"></a> Larger Blocks</h3>
<ul>
<li>larger data can be transferred in one disk transaction</li>
<li>larger blocks waste space for small files.
<ul>
<li>Solution: allow the division of a single file system block into one or more fragments. Block can be broken optionally into 2, 4, or 8 fragments, each of which  is addressable.</li>
<li>The block map associated with each cylinder group records the space available in a cylinder group at the fragment level.</li>
<li>To gain performance, use block to allocate if possible</li>
</ul>
</li>
<li>Since file systems with different block sizes may reside on the same system, the file system interface has been extended to provide application programs the optimal size for a read or write:
<ul>
<li>For files, the optimal size is the block size of the file system on which the file is being accessed.</li>
<li>For other objects, such as pipes and sockets, the optimal size is the underlying buffer size.</li>
</ul>
</li>
<li>A file system cannot be kept completely full.
<ul>
<li>The free space  reserve, that gives the minimum acceptable percentage of file system blocks that should be free.</li>
</ul>
</li>
<li>The percentage of waste is comparable to old file system.</li>
</ul>
<h3 id="file-system-parameterization"><a class="markdownIt-Anchor" href="#file-system-parameterization"></a> File System Parameterization</h3>
<ul>
<li>Files are tried to allocate on the consecutive blocks on the same cylinder.</li>
<li>On a processor with an I/O channel that <strong>does not require any processor intervention</strong> between mass storage transfer requests, two consecutive disk blocks can often be accessed without suffering lost time because of an intervening disk revolution.</li>
<li>For processors without I/O channels, the main processor must field an interrupt and prepare for a new disk transfer. The expected time to service this interrupt and schedule a new disk transfer depends on the speed of the main processor.</li>
<li>Based on the physical characteristics of each disk, the allocation routines can calculate the number of milliseconds required to skip over a block.</li>
</ul>
<h3 id="layout-policies"><a class="markdownIt-Anchor" href="#layout-policies"></a> Layout Policies</h3>
<ul>
<li>Two distinct parts:
<ul>
<li>Global policies: use file system wide summary information to make  decisions regarding the placement of new inodes and data blocks</li>
<li>Local allocation routines: use a locally optimal scheme to lay out data  blocks</li>
</ul>
</li>
<li>Two methods for improving file system performance
<ul>
<li>Increase the locality of reference to minimize seek latency</li>
<li>Improve  the layout of data to make larger transfers possible</li>
</ul>
</li>
<li>Global policies try to balance between:
<ul>
<li>localizing  data that are concurrently accessed
<ul>
<li>Too much may become old file system</li>
</ul>
</li>
<li>spreading out unrelated data
<ul>
<li>Too much may cause low latency</li>
</ul>
</li>
</ul>
</li>
<li>The policy routines try to place all data blocks for a  file in the same cylinder group, but redirect block allocation to a different cylinder group when a file exceeds 48 kilobytes
<ul>
<li>Avoid becoming completely full.</li>
</ul>
</li>
</ul>
<h3 id="performance"><a class="markdownIt-Anchor" href="#performance"></a> Performance</h3>
<ul>
<li>Use much more bandwidth(47% vs 3-5%)</li>
<li>Faster RW</li>
<li>The reading rate is always at least as fast as the writing rate
<ul>
<li>In contrast the old file system is about 50 percent faster at writing files than reading them.
<ul>
<li>Because the write system call is asynchronous and the kernel can generate disk transfer requests much faster than they can be serviced.</li>
</ul>
</li>
</ul>
</li>
<li>The performance is limited memory copy operations.</li>
</ul>
<h3 id="file-system-functional-enhancements"><a class="markdownIt-Anchor" href="#file-system-functional-enhancements"></a> FILE SYSTEM FUNCTIONAL ENHANCEMENTS</h3>
<ul>
<li>Long File Names
<ul>
<li>255 characters.</li>
<li>Use directories entry.</li>
</ul>
</li>
<li>File Locking
<ul>
<li>Use a separate &quot;lock&quot; file.</li>
</ul>
</li>
<li>Symbolic Links</li>
<li>Rename</li>
<li>Quotas</li>
</ul>
<h2 id="advantages"><a class="markdownIt-Anchor" href="#advantages"></a> Advantages</h2>
<ul>
<li>Fast</li>
<li>Larger file is supported</li>
</ul>
<h2 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> Reference</h2>
<h1 id="the-design-and-implementation-of-a-log-structured-file-system"><a class="markdownIt-Anchor" href="#the-design-and-implementation-of-a-log-structured-file-system"></a> The Design and Implementation of a Log-Structured File System</h1>
<ul>
<li>Log in the only structure.</li>
<li>Use segment cleaner to compress</li>
<li>Use high bandwidth(70% vs 5-10%)</li>
</ul>
<h2 id="introduction-2"><a class="markdownIt-Anchor" href="#introduction-2"></a> Introduction</h2>
<ul>
<li>Assumptions:
<ul>
<li>files are cached in main memory and increasing memory sizes will make the caches more and more effective at satisfying read requests
<ul>
<li>-&gt; disk traffic will become dominated by writes</li>
</ul>
</li>
</ul>
</li>
<li>Sequential nature
<ul>
<li>write performance</li>
<li>faster crash recovery</li>
</ul>
</li>
<li>Difference from others:
<ul>
<li>Others use log to do speeding up and crash recovery</li>
<li>LFS only use log.</li>
</ul>
</li>
<li>Challenge: GC</li>
</ul>
<h2 id="core-ideas-2"><a class="markdownIt-Anchor" href="#core-ideas-2"></a> Core Ideas</h2>
<h3 id="design-for-file-systems-of-the-1990s"><a class="markdownIt-Anchor" href="#design-for-file-systems-of-the-1990s"></a> Design for file systems of the 1990’s</h3>
<h4 id="problems-with-existing-file-systems"><a class="markdownIt-Anchor" href="#problems-with-existing-file-systems"></a> Problems with existing file systems</h4>
<ul>
<li>FFS
<ul>
<li>physically separates different files</li>
<li>separate inodes</li>
<li>the directory entry containing the file’s name</li>
<li>takes at least five separate disk I/Os, each preceded by a seek, to create a new file</li>
</ul>
</li>
<li>tend to write synchronously</li>
</ul>
<h3 id="log-structured-file-systems"><a class="markdownIt-Anchor" href="#log-structured-file-systems"></a> Log-structured file systems</h3>
<ul>
<li>Fundamental idea
<ul>
<li><strong>buffering</strong> a sequence of file system changes in the file cache and then writing all the changes to disk <strong>sequentially</strong> in a single disk write operation.</li>
</ul>
</li>
<li>LFS Converts the many small synchronous random writes of traditional file systems into large asynchronous sequential transfers that can utilize nearly 100% of the raw disk bandwidth.</li>
</ul>
<h4 id="file-location-and-reading"><a class="markdownIt-Anchor" href="#file-location-and-reading"></a> File location and reading</h4>
<ul>
<li>Inode
<ul>
<li>10 direct address.</li>
<li>one or more indirect blocks.</li>
<li>Sprite LFS doesn’t place inodes at fixed positions; they are written to the log</li>
</ul>
</li>
</ul>
<h4 id="free-space-management-segments"><a class="markdownIt-Anchor" href="#free-space-management-segments"></a> Free space management: segments</h4>
<ul>
<li>Two choices
<ul>
<li>Threading
<ul>
<li>Skip the blocks containing newest data</li>
<li>Sparse, not contiguous.</li>
</ul>
</li>
<li>Copying
<ul>
<li>Compress</li>
<li>Copying overhead</li>
</ul>
</li>
</ul>
</li>
<li>LFS:
<ul>
<li>Any given segment(512KB or 1MB) is always written sequentially from its beginning to its end, and all live data must be copied out of a segment before the segment can be rewritten.</li>
</ul>
</li>
</ul>
<h4 id="segment-cleaning-mechanism"><a class="markdownIt-Anchor" href="#segment-cleaning-mechanism"></a> Segment cleaning mechanism</h4>
<ul>
<li>Three-step algorithm
<ul>
<li>Read N dirty segments.</li>
<li>Identify which blocks are live.</li>
<li>Write live data back to log.</li>
</ul>
</li>
<li>Writing a segment summary block as part of each segment.
<ul>
<li>Identifies each file appearing in segment and each block in each file.</li>
<li>little overhead during writing, but useful during crash recovery.</li>
</ul>
</li>
<li>Checking alive:
<ul>
<li>segment summary information -&gt; block’s identity -&gt; file’s inode -&gt; check file’s inode</li>
<li>a version number in the inode map entry is used to quickly check</li>
</ul>
</li>
</ul>
<h4 id="segment-cleaning-policies"><a class="markdownIt-Anchor" href="#segment-cleaning-policies"></a> Segment cleaning policies</h4>
<ul>
<li>When should the cleaner run?</li>
<li>How many segments should be cleaned at once?</li>
<li>Which segments should be cleaned? (more important)</li>
<li>How should cleaned blocks be grouped? (more important)</li>
</ul>
<h4 id="simulation-results"><a class="markdownIt-Anchor" href="#simulation-results"></a> Simulation results</h4>
<h4 id="segment-usage-table"><a class="markdownIt-Anchor" href="#segment-usage-table"></a> Segment usage table</h4>
<ul>
<li>segment usage table
<ul>
<li>For each segment, the table records the number of live bytes in the segment and the most recent modified time of any block in the segment.</li>
</ul>
</li>
</ul>
<h3 id="crash-recovery"><a class="markdownIt-Anchor" href="#crash-recovery"></a> Crash recovery</h3>
<ul>
<li>Know where last mods were (end of log), so know where any inconsistencies might be).</li>
<li>Use checkpoints and roll-forward to recover.</li>
</ul>
<h4 id="checkpoints"><a class="markdownIt-Anchor" href="#checkpoints"></a> Checkpoints</h4>
<ul>
<li>Flush all modified data, write inode map, segment usage table, and end- of-log pointer to checkpoint region.</li>
<li>At reboot, read each of two checkpoint regions, initialize structures from the checkpoint. (assumption: last byte of region is last byte read)</li>
<li>Checkpoint every 30 seconds (should checkpoint after some amount of data has been written).</li>
</ul>
<h4 id="roll-forward"><a class="markdownIt-Anchor" href="#roll-forward"></a> Roll-forward</h4>
<ul>
<li>Read segments written after the last checkpoint.</li>
<li>Can lose recently created files if data blocks were written, but inode was not.</li>
<li>Use write-ahead logging to maintain consistency between directory entries and inodes.</li>
</ul>
<h2 id="lectures"><a class="markdownIt-Anchor" href="#lectures"></a> Lectures</h2>
<ul>
<li>The assumption of the paper is not that reasonable. The cache cannot cover all the read. And the write performance is actually hard to examine as most of the write is actually to cache (system cache or firmware cache) instead of directly to disk.</li>
<li>Though it did not foresee the SSD's characteristics, it did fit SSD well.</li>
</ul>
<h2 id="reference-2"><a class="markdownIt-Anchor" href="#reference-2"></a> Reference</h2>

    </div>

    
    
    
        <div class="reward-container">
  <div></div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    Donate
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="Kexiang Wang Alipay">
        <p>Alipay</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:  </strong>Kexiang Wang
  </li>
  <li class="post-copyright-link">
    <strong>Post link: </strong>
    <a href="https://www.kexiang.me/2021/10/28/1759-OCT-28/" title="1759 &#39;File System&#39; OCT-28">https://www.kexiang.me/2021/10/28/1759-OCT-28/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>Welcome to my other publishing channels</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/KexiangW">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="https://www.linkedin.com/in/kexiang-wang-73b6171a0/">
            <span class="icon">
              <i class="fab fa-linkedin-in"></i>
            </span>

            <span class="label">Linkedin</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="https://www.zhihu.com/people/wang-ke-xiang-52">
            <span class="icon">
              <i class="fab fa-zhihu"></i>
            </span>

            <span class="label">Zhihu</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Systems/" rel="tag"># Systems</a>
              <a href="/tags/Paper-Reading/" rel="tag"># Paper Reading</a>
              <a href="/tags/OS/" rel="tag"># OS</a>
              <a href="/tags/File-Systems/" rel="tag"># File Systems</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/10/21/1759-OCT-21/" rel="prev" title="1759 'Distribution' OCT-21">
      <i class="fa fa-chevron-left"></i> 1759 'Distribution' OCT-21
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/11/08/seda-an-architecture-for-well-conditioned-scalable-internet-services/" rel="next" title="SEDA: An Architecture for Well-Conditioned, Scalable Internet Services">
      SEDA: An Architecture for Well-Conditioned, Scalable Internet Services <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#a-fast-file-system-for-unix"><span class="nav-number">1.</span> <span class="nav-text"> A Fast File System for Unix</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#introduction"><span class="nav-number">1.1.</span> <span class="nav-text"> Introduction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#core-ideas"><span class="nav-number">1.2.</span> <span class="nav-text"> Core Ideas</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ffs"><span class="nav-number">1.2.1.</span> <span class="nav-text"> FFS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#larger-blocks"><span class="nav-number">1.2.2.</span> <span class="nav-text"> Larger Blocks</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#file-system-parameterization"><span class="nav-number">1.2.3.</span> <span class="nav-text"> File System Parameterization</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#layout-policies"><span class="nav-number">1.2.4.</span> <span class="nav-text"> Layout Policies</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#performance"><span class="nav-number">1.2.5.</span> <span class="nav-text"> Performance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#file-system-functional-enhancements"><span class="nav-number">1.2.6.</span> <span class="nav-text"> FILE SYSTEM FUNCTIONAL ENHANCEMENTS</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#advantages"><span class="nav-number">1.3.</span> <span class="nav-text"> Advantages</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reference"><span class="nav-number">1.4.</span> <span class="nav-text"> Reference</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#the-design-and-implementation-of-a-log-structured-file-system"><span class="nav-number">2.</span> <span class="nav-text"> The Design and Implementation of a Log-Structured File System</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#introduction-2"><span class="nav-number">2.1.</span> <span class="nav-text"> Introduction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#core-ideas-2"><span class="nav-number">2.2.</span> <span class="nav-text"> Core Ideas</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#design-for-file-systems-of-the-1990s"><span class="nav-number">2.2.1.</span> <span class="nav-text"> Design for file systems of the 1990’s</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#problems-with-existing-file-systems"><span class="nav-number">2.2.1.1.</span> <span class="nav-text"> Problems with existing file systems</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#log-structured-file-systems"><span class="nav-number">2.2.2.</span> <span class="nav-text"> Log-structured file systems</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#file-location-and-reading"><span class="nav-number">2.2.2.1.</span> <span class="nav-text"> File location and reading</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#free-space-management-segments"><span class="nav-number">2.2.2.2.</span> <span class="nav-text"> Free space management: segments</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#segment-cleaning-mechanism"><span class="nav-number">2.2.2.3.</span> <span class="nav-text"> Segment cleaning mechanism</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#segment-cleaning-policies"><span class="nav-number">2.2.2.4.</span> <span class="nav-text"> Segment cleaning policies</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#simulation-results"><span class="nav-number">2.2.2.5.</span> <span class="nav-text"> Simulation results</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#segment-usage-table"><span class="nav-number">2.2.2.6.</span> <span class="nav-text"> Segment usage table</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#crash-recovery"><span class="nav-number">2.2.3.</span> <span class="nav-text"> Crash recovery</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#checkpoints"><span class="nav-number">2.2.3.1.</span> <span class="nav-text"> Checkpoints</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#roll-forward"><span class="nav-number">2.2.3.2.</span> <span class="nav-text"> Roll-forward</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#lectures"><span class="nav-number">2.3.</span> <span class="nav-text"> Lectures</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#reference-2"><span class="nav-number">2.4.</span> <span class="nav-text"> Reference</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Kexiang Wang"
      src="/images/avatar-time.jpg">
  <p class="site-author-name" itemprop="name">Kexiang Wang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/KeXiangWang" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;KeXiangWang" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/kexiang-wang-73b6171a0/" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;kexiang-wang-73b6171a0&#x2F;" rel="noopener" target="_blank"><i class="fab fa-linkedin-in fa-fw"></i>Linkedin</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/wang-ke-xiang-52" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;wang-ke-xiang-52" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i>Zhihu</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/KexiangW" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;KexiangW" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ke.wang@hotmail.com" title="E-Mail → mailto:ke.wang@hotmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Kexiang Wang</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">Symbols count total: </span>
    <span title="Symbols count total">127k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">Reading time total &asymp;</span>
    <span title="Reading time total">1:55</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>



        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>















  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('/js/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : true,
      appId      : '5F4DdksFXCxgcPFJfYq2raiB-gzGzoHsz',
      appKey     : '36G9n5NWIiCjzVVLQFf5B0QF',
      placeholder: "Any comments are welcomed! Please leave your E-Mail if you want to be contacted!",
      avatar     : 'retro',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'en' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
